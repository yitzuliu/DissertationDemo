<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vision Intelligence Hub</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Header with logo and status -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-brain"></i>
            <span>Vision Intelligence Hub</span>
        </div>
        <div class="header-status">
            <div class="status-item">
                <span class="status-dot" id="apiStatusDot"></span>
                <span id="apiStatusText">Checking API status...</span>
            </div>
            <div class="status-item">
                <i class="fas fa-microchip"></i>
                <span id="activeModel">Loading model...</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Main Content Area -->
        <div class="main-content">
            <div class="main-content-flex" style="display: flex; flex-direction: column; height: 100%; overflow: hidden;">
                <!-- Video and Controls Card -->
                <div class="card" style="flex-grow: 1; display: flex; flex-direction: column; margin-bottom: 0.5rem; overflow: hidden;">
                    <div class="card-header" style="margin-bottom: 0.5rem; padding-bottom: 0.5rem;">
                        <h2 class="card-title">
                            <i class="fas fa-video"></i>
                            Live Camera Feed & Controls
                        </h2>
                    </div>
                    
                    <!-- Content area with video and controls side by side -->
                    <div style="display: flex; gap: 0.75rem; height: 100%; overflow: hidden;">
                        <!-- Video container - takes 65% width -->
                        <div style="flex: 13; display: flex; flex-direction: column; min-height: 0;">
                            <div class="video-container" style="flex-grow: 1; margin-bottom: 0.5rem;">
                                <video id="videoFeed" class="video-preview" autoplay playsinline></video>
                                <canvas id="canvas" style="display:none;"></canvas>
                            </div>
                            <div class="thumbnail-container" style="display: flex; align-items: center; gap: 0.5rem;">
                                <img id="imagePreview" class="image-preview" style="width: 80px; height: 60px; display:none;" />
                                <span class="capture-label" style="font-size: 0.7rem; min-width: 150px;">Last captured frame</span>
                            </div>
                        </div>
                        
                        <!-- Controls container - takes 35% width -->
                        <div style="flex: 7; display: flex; flex-direction: column;">
                            <div class="form-group" style="margin-bottom: 0.5rem;">
                                <label for="instructionText" style="font-size: 0.7rem;">Ask about the image:</label>
                                <textarea id="instructionText" rows="2" style="height: 60px; resize: none; font-size: 0.8rem;" placeholder="Enter question about the image..."></textarea>
                            </div>
                            
                            <div style="margin-bottom: 0.5rem; font-size: 0.7rem; color: var(--text-light);">
                                <strong>Processing Settings:</strong>
                            </div>
                            
                            <div class="parameter-grid" style="grid-template-columns: 1fr; gap: 0.4rem;">
                                <div class="form-group">
                                    <label for="cameraSelect" style="font-size: 0.7rem;">Select Camera</label>
                                    <select id="cameraSelect" style="padding: 0.35rem 0.25rem; font-size: 0.75rem;"></select>
                                </div>
                                <div>
                                    <label for="intervalSelect" style="font-size: 0.7rem;">Capture Rate</label>
                                    <select id="intervalSelect" style="padding: 0.35rem 0.25rem; font-size: 0.75rem;"></select>
                                </div>
                                <div>
                                    <label for="qualitySelect" style="font-size: 0.7rem;">Image Quality</label>
                                    <select id="qualitySelect" style="padding: 0.35rem 0.25rem; font-size: 0.75rem;">
                                        <option value="0.7">Fast</option>
                                        <option value="0.8">Medium</option>
                                        <option value="0.9" selected>High</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="tokensSelect" style="font-size: 0.7rem;">Max Tokens</label>
                                    <select id="tokensSelect" style="padding: 0.35rem 0.25rem; font-size: 0.75rem;">
                                        <option value="100" selected>100</option>
                                        <option value="200">200</option>
                                        <option value="300">300</option>
                                    </select>
                                </div>
                                <div>
                                    <button id="startButton" class="btn btn-primary" style="width: 100%; padding: 0.35rem 0.25rem; font-size: 0.75rem;">
                                        <i class="fas fa-play"></i>
                                        <span>Start</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div id="modelHelp" class="help-msg" style="margin-top: 0.5rem; padding: 0.5rem; font-size: 0.7rem;"></div>
                            <div id="errorMsg" class="error-msg" style="margin-top: 0.5rem; padding: 0.5rem; font-size: 0.7rem; display:none;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Response Card -->
                <div class="card" style="height: 300px; overflow: hidden; margin-bottom: 0;">
                    <div class="card-header" style="margin-bottom: 0.25rem; padding-bottom: 0.25rem;">
                        <h2 class="card-title">
                            <i class="fas fa-comment-dots"></i>
                            Model Response
                        </h2>
                    </div>
                    <textarea id="responseText" style="height: 255px; resize: none; font-size: 0.8rem; overflow-y: auto;" readonly placeholder="AI responses will appear here..."></textarea>
                </div>
            </div>
        </div>
        
        <!-- Sidebar with info cards -->
        <div class="sidebar" style="display: flex; flex-direction: column; height: 100%; overflow: hidden; min-width: 220px; max-width: 280px;">
            <!-- System Status Card -->
            <div class="card" style="margin-bottom: 0.5rem;">
                <div class="card-header" style="margin-bottom: 0.25rem; padding-bottom: 0.25rem;">
                    <h2 class="card-title">
                        <i class="fas fa-server"></i>
                        System Status
                    </h2>
                </div>
                <div class="system-status" id="systemStatus" style="padding: 0.5rem; font-size: 0.75rem; margin: 0;">Loading system information...</div>
            </div>
            
            <!-- Info accordion panel -->
            <div class="accordion-container" style="flex-grow: 1; display: flex; flex-direction: column;">
                <div class="card" style="flex-grow: 1; margin-bottom: 0; overflow: hidden; display: flex; flex-direction: column;">
                    <!-- Tabs for model info and tips -->
                    <div class="tabs-container">
                        <div class="tabs-header" style="display: flex; border-bottom: 1px solid var(--border-light); padding-bottom: 0.5rem; margin-bottom: 0.5rem;">
                            <h2 class="tab-btn active-tab" data-target="model-panel" style="margin: 0; flex: 1; text-align: center; padding: 0.25rem; border-bottom: 2px solid var(--primary); font-size: 0.8rem; cursor: pointer;">
                                <i class="fas fa-info-circle"></i>
                                Info
                            </h2>
                            <h2 class="tab-btn" data-target="tips-panel" style="margin: 0; flex: 1; text-align: center; padding: 0.25rem; opacity: 0.6; cursor: pointer; font-size: 0.8rem;">
                                <i class="fas fa-lightbulb"></i>
                                Tips
                            </h2>
                        </div>
                    
                        <!-- Content panels -->
                        <div class="tab-content" style="overflow-y: auto; flex-grow: 1;">
                            <!-- Model info content -->
                            <div id="model-panel" class="tab-panel active" style="padding: 0.5rem; font-size: 0.75rem;">
                                <div id="modelDesc">Loading model details...</div>
                            </div>
                            
                            <!-- Tips content -->
                            <div id="tips-panel" class="tab-panel" style="display: none;">
                                <ul class="advice-list" style="margin: 0; padding: 0.5rem; font-size: 0.75rem; list-style-type: none;">
                                    <li style="padding: 0.25rem 0 0.25rem 1.25rem; margin-bottom: 0.5rem; position: relative;">Ensure camera permissions are enabled.</li>
                                    <li style="padding: 0.25rem 0 0.25rem 1.25rem; margin-bottom: 0.5rem; position: relative;">Check instruction format if errors occur.</li>
                                    <li style="padding: 0.25rem 0 0.25rem 1.25rem; margin-bottom: 0.5rem; position: relative;">Adjust capture rate based on connection speed.</li>
                                    <li style="padding: 0.25rem 0 0.25rem 1.25rem; position: relative;">Higher image quality provides better results.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script type="module" src="js/main.js"></script>
</body>
</html>